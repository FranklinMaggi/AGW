(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21002,e=>{"use strict";var a=e.i(43476),s=e.i(71645),l=e.i(18566);function t(){let{id:e}=(0,l.useParams)(),t=(0,l.useSearchParams)().get("token"),[n,d]=(0,s.useState)(null),[r,c]=(0,s.useState)(!0),[m,u]=(0,s.useState)(!1),[o,p]=(0,s.useState)("");async function x(){c(!0);let a=await fetch("https://agw.franklin19.workers.dev/api/user/get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),s=await a.json();d(s.error?null:s),c(!1)}async function h(a,s){if(!n)return;u(!0),p("");let l={...n},i=a.split("."),r=l;for(let e=0;e<i.length-1;e++)r=r[i[e]];r[i[i.length-1]]=s;let c=await fetch("https://agw.franklin19.workers.dev/api/admin/user/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,id:e,userData:l})}),m=await c.json();if(m.error){p("❌ "+m.error),u(!1);return}d(m.user),p("✔ Saved"),u(!1)}return((0,s.useEffect)(()=>{t&&x()},[t]),t)?r?(0,a.jsx)("p",{className:"p-6 admin-muted",children:"Loading..."}):n?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("h1",{className:"admin-title text-3xl font-bold",children:["Editing User #",n.index," — ",n.nickname]}),(0,a.jsx)("p",{className:"admin-muted",children:o}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Avatar & Identity"}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("img",{src:n.profile_image||n.avatar_ai||"/default-avatar.png",className:"w-24 h-24 rounded-full object-cover border border-[var(--admin-border)]"}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("p",{className:"admin-muted text-sm",children:"Profile image and AI avatar management coming soon"}),(0,a.jsx)("button",{className:"admin-btn admin-btn-blue opacity-60 cursor-not-allowed",children:"Upload Profile Image (soon)"}),(0,a.jsx)("button",{className:"admin-btn admin-btn-gold opacity-60 cursor-not-allowed",children:"Generate AI Avatar (soon)"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Nickname"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.nickname,onBlur:e=>h("nickname",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"First name"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.firstname,onBlur:e=>h("firstname",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Last name"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.lastname,onBlur:e=>h("lastname",e.target.value)})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Mailing / Contact"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Primary Email"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.mailing.primary,onBlur:e=>h("mailing.primary",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Secondary Email"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.mailing.secondary||"",onBlur:e=>h("mailing.secondary",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Phone"}),(0,a.jsx)("input",{className:"admin-input",defaultValue:n.phone||"",onBlur:e=>h("phone",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:"Verified?"}),(0,a.jsxs)("select",{className:"admin-input",defaultValue:String(n.mailing.verified),onChange:e=>h("mailing.verified","true"===e.target.value),children:[(0,a.jsx)("option",{value:"true",children:"True"}),(0,a.jsx)("option",{value:"false",children:"False"})]})]})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Personal Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(i,{label:"Birthdate",value:n.personal.birthdate,update:e=>h("personal.birthdate",e)}),(0,a.jsx)(i,{label:"Gender",value:n.personal.gender,update:e=>h("personal.gender",e)}),(0,a.jsx)(i,{label:"Job",value:n.personal.job,update:e=>h("personal.job",e)}),(0,a.jsx)(i,{label:"Weight (kg)",value:n.personal.weight,update:e=>h("personal.weight",Number(e))}),(0,a.jsx)(i,{label:"Height (cm)",value:n.personal.height,update:e=>h("personal.height",Number(e))})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Stats"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(i,{label:"Level (total)",value:n.stats.level_total,update:e=>h("stats.level_total",Number(e))}),(0,a.jsx)(i,{label:"Level (year)",value:n.stats.level_year,update:e=>h("stats.level_year",Number(e))}),(0,a.jsx)(i,{label:"Rank (month)",value:n.stats.rank_month,update:e=>h("stats.rank_month",Number(e))}),(0,a.jsx)(i,{label:"Motivation (week)",value:n.stats.motivation_week,update:e=>h("stats.motivation_week",Number(e))}),(0,a.jsx)(i,{label:"KRM total",value:n.stats.krm_total,update:e=>h("stats.krm_total",Number(e))}),(0,a.jsx)(i,{label:"KRM year",value:n.stats.krm_year,update:e=>h("stats.krm_year",Number(e))}),(0,a.jsx)(i,{label:"KRM month",value:n.stats.krm_month,update:e=>h("stats.krm_month",Number(e))}),(0,a.jsx)(i,{label:"KRM week",value:n.stats.krm_week,update:e=>h("stats.krm_week",Number(e))}),(0,a.jsx)(i,{label:"KRM day",value:n.stats.krm_day,update:e=>h("stats.krm_day",Number(e))})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Discipline"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(i,{label:"Daily Completed",value:n.discipline.daily_completed,update:e=>h("discipline.daily_completed",Number(e))}),(0,a.jsx)(i,{label:"Daily Goal",value:n.discipline.daily_goal,update:e=>h("discipline.daily_goal",Number(e))}),(0,a.jsx)(i,{label:"Weekly Completed",value:n.discipline.weekly_completed,update:e=>h("discipline.weekly_completed",Number(e))}),(0,a.jsx)(i,{label:"Weekly Goal",value:n.discipline.weekly_goal,update:e=>h("discipline.weekly_goal",Number(e))})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Subscription"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(i,{label:"Type",value:n.subscription.type,update:e=>h("subscription.type",e)}),(0,a.jsx)(i,{label:"Payment Status",value:n.subscription.payment_status,update:e=>h("subscription.payment_status",e)}),(0,a.jsx)(i,{label:"Expires At",value:n.subscription.expires_at,update:e=>h("subscription.expires_at",Number(e))})]})]}),(0,a.jsxs)("section",{className:"admin-card p-6 space-y-4",children:[(0,a.jsx)("h2",{className:"admin-title text-xl",children:"Bonus"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(i,{label:"Award",value:n.bonus?.award,update:e=>h("bonus.award",e)}),(0,a.jsx)(i,{label:"Expires",value:n.bonus?.expiresAt,update:e=>h("bonus.expiresAt",Number(e))})]})]}),(0,a.jsx)("div",{className:"admin-card p-6",children:(0,a.jsx)("button",{className:"admin-btn admin-btn-danger",onClick:async()=>{if(!confirm("Confermi l'eliminazione DEFINITIVA di questo utente?"))return;let e=await fetch("https://agw.franklin19.workers.dev/api/admin/user/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,id:n.id,field:"delete"})});(await e.json()).deleted?(alert("Utente eliminato con successo."),window.location.href=`/admin/users?token=${t}`):alert("Errore durante l'eliminazione.")},children:"Delete User"})})]}):(0,a.jsx)("p",{className:"p-6 text-red-400",children:"User not found"}):(0,a.jsx)("p",{className:"admin-muted p-6",children:"Missing token"})}function i({label:e,value:s,update:l}){return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"admin-muted text-sm",children:e}),(0,a.jsx)("input",{className:"admin-input",defaultValue:null!=s?String(s):"",onBlur:e=>{let a=e.target.value;"number"==typeof s&&(a=Number(a)),l(a)}})]})}e.s(["default",()=>t])}]);